<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>黑白局 - 线上看</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.1/dist/hls.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #2c2c2c; color: #fff; margin: 0; padding: 0; }
    .container { max-width: 1200px; margin: 20px auto; padding: 0 10px; }
    .player { margin-bottom: 20px; position: relative; }
    video { width: 100%; height: auto; background: black; touch-action: pan-y; }

    /* 暂停时显示标题 */
    .overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      background: rgba(0,0,0,0.6);
      padding: 15px 25px;
      border-radius: 8px;
      font-size: 22px;
      display: none;
      text-align: center;
    }

    /* 控制按钮放大 */
    video::-webkit-media-controls-volume-slider,
    video::-webkit-media-controls-mute-button,
    video::-webkit-media-controls-fullscreen-button {
      transform: scale(1.5);
      margin: 0 6px;
    }

    .nav-buttons { display: flex; justify-content: center; gap: 15px; margin: 10px 0; }
    .nav-buttons button { background: #444; color: #fff; border: none; padding: 10px 20px; cursor: pointer; border-radius: 4px; transition: 0.2s; }
    .nav-buttons button:hover { background: #555; }

    .playlist { display: flex; flex-wrap: wrap; gap: 10px; padding: 10px 0; justify-content: center; }
    .playlist button { background: #444; color: #fff; border: none; padding: 10px 15px; cursor: pointer; border-radius: 4px; transition: 0.2s; }
    .playlist button:hover { background: #555; }
    .playlist button.active { background: #1e90ff; }

    .details { background: #1c1c1c; padding: 15px; border-radius: 8px; }
    .details h1 { margin: 0 0 10px 0; font-size: 24px; }
    .details p { margin: 5px 0; line-height: 1.5; }
    .details strong { color: #1e90ff; }
  </style>
</head>
<body>

<div class="container">
  <div class="player">
    <video id="video" controls playsinline></video>
    <div id="overlay" class="overlay"></div>
  </div>

  <div class="nav-buttons">
    <button id="prev">上一集</button>
    <button id="next">下一集</button>
  </div>

  <div class="playlist" id="playlist"></div>

  <div class="details">
    <h1 id="title">黑白局 - 電視劇</h1>
    <p><strong>状态:</strong> <span id="status">第20集完結</span></p>
    <p><strong>类别:</strong> <span id="category">大陸電視劇</span></p>
    <p><strong>导演:</strong> <span id="director">趙浚凱, 侯傑</span></p>
    <p><strong>主演:</strong> <span id="actors">楊旭文, 王硯輝</span></p>
    <p><strong>国家/语言/年代:</strong> <span id="meta">大陸 / 漢語普通話 / 2025</span></p>
    <p><strong>剧情介绍:</strong></p>
    <p id="description">展鵬（楊旭文 飾）的父親是一名鐵路警察...</p>
  </div>
</div>

<script>
const episodes = {
  "第1集": "https://cdn.wlcdn88.com:777/d1154710/index.m3u8",
  "第2集": "https://cdn.wlcdn88.com:777/24a79096/index.m3u8",
  "第3集": "https://cdn.wlcdn88.com:777/876c7a10/index.m3u8",
  "第4集": "https://cdn.wlcdn88.com:777/08e571a4/index.m3u8",
  "第20集": "https://cdn.wlcdn88.com:777/b4d5c158/index.m3u8"
};

const video = document.getElementById('video');
const playlist = document.getElementById('playlist');
const overlay = document.getElementById('overlay');
const titleEl = document.getElementById('title');
let currentIndex = 0;

function loadEpisode(index, btn) {
  const keys = Object.keys(episodes);
  const url = Object.values(episodes)[index];
  if (!url) return;

  if(Hls.isSupported()) {
    const hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
    hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
  } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
    video.src = url;
    video.addEventListener('loadedmetadata', () => video.play());
  }

  document.querySelectorAll('#playlist button').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');

  currentIndex = index;
  titleEl.textContent = "黑白局 - " + keys[index];
  overlay.textContent = "黑白局 - " + keys[index];
}

// 生成集数按钮
Object.entries(episodes).forEach(([ep, url], index) => {
  const btn = document.createElement('button');
  btn.textContent = ep;
  btn.onclick = () => loadEpisode(index, btn);
  playlist.appendChild(btn);
});

// 上一集 / 下一集
document.getElementById('prev').onclick = () => {
  if (currentIndex > 0) {
    const btn = playlist.children[currentIndex - 1];
    loadEpisode(currentIndex - 1, btn);
  }
};
document.getElementById('next').onclick = () => {
  if (currentIndex < Object.keys(episodes).length - 1) {
    const btn = playlist.children[currentIndex + 1];
    loadEpisode(currentIndex + 1, btn);
  }
};

// 暂停/播放显示标题
video.addEventListener('pause', () => { overlay.style.display = 'block'; });
video.addEventListener('play', () => { overlay.style.display = 'none'; });

// 手机上下滑动切换集数
let touchStartY = 0;
video.addEventListener('touchstart', e => { touchStartY = e.changedTouches[0].screenY; });
video.addEventListener('touchend', e => {
  let diffY = e.changedTouches[0].screenY - touchStartY;
  if (Math.abs(diffY) > 50) {
    if (diffY > 0) document.getElementById('prev').click(); // 下滑 → 上一集
    else document.getElementById('next').click();           // 上滑 → 下一集
  }
});

// 默认播放第1集
const firstBtn = playlist.querySelector('button');
firstBtn.classList.add('active');
loadEpisode(0, firstBtn);
</script>

</body>
</html>
