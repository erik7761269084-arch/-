<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÂõΩ‰∫ßAV - ÂΩ±ÁâáÂàóË°®</title>
<style>
body {
  margin: 0;
  font-family: "ÂæÆËΩØÈõÖÈªë", sans-serif;
  background-color: #0d0d0d;
  color: #fff;
  padding-top: 60px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 20px;
  padding: 20px;
}

.card {
  position: relative;
  background-color: #1a1a1a;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  display: flex;
  flex-direction: column;
}
.card:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(255,255,255,0.2); }
.card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }

.card-type {
  position: absolute; bottom: 8px; right: 8px;
  font-size: 12px; font-weight: bold; color:#fff;
  background:#ff0000; padding:2px 6px; border-radius:4px;
}

.actor {
  position: absolute; bottom: 8px; left: 8px;
  background: rgba(0,0,0,0.5);
  padding:2px 6px; border-radius:4px; font-size:12px;
}

.card-info { padding: 8px 10px; display: flex; flex-direction: column; gap: 6px; }

.card-info-top { display: flex; align-items: center; gap: 6px; overflow: hidden; }
.idcode { color: #ffcc00; font-weight: bold; font-size: 12px; white-space: nowrap; }
.title { font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex-grow:1; }

.card-info-bottom { display: flex; justify-content: space-between; font-size:12px; color:#ccc; }
.star { color: gold; }
.date { display:flex; align-items:center; gap:4px; }
.date::before { content:"üìÖ"; }

.pagination {
  display: flex; justify-content:center; align-items:center; gap:6px;
  padding: 20px 0 40px;
}
.pagination button {
  padding: 6px 12px; background:#333; color:#fff;
  border:none; border-radius:4px; cursor:pointer;
}
.pagination button:hover:not(:disabled) { background:#555; }
.pagination button:disabled { opacity:.4; cursor:not-allowed; }
.pagination input { width:50px; padding:4px; background:#222; border:1px solid #555; color:#fff; text-align:center; border-radius:4px; }

</style>
</head>
<body>

<div id="header-placeholder"></div>

<div id="dramaSection">
  <div class="grid" id="dramaGrid"></div>
  <div class="pagination" id="pagination"></div>
</div>

<script>
fetch('header.html')
  .then(r=>r.text())
  .then(html=>{
    document.getElementById('header-placeholder').innerHTML = html;
    const s=document.createElement('script'); s.src='header.js'; document.body.appendChild(s);
  });

fetch('https://yunvgong.com/footer.html')
  .then(r=>r.text())
  .then(html=>{
    const footer=document.createElement('div');
    footer.innerHTML = html;
    document.body.appendChild(footer);
  });

let dramas=[], currentPage=1, pageSize=24;
const basePath="https://yunvgong.com/JAV/category/main_page/";

async function loadDramas(){
  let i=1;
  while(true){
    const url=`${basePath}page_${i}.json`;
    try{
      const res=await fetch(url);
      if(!res.ok) break;
      const data=await res.json();
      if(!data?.length) break;
      dramas.push(...data);
      i++;
    }catch{ break; }
  }
  renderPage(currentPage);
}

function renderPage(p){
  const box=document.getElementById('dramaGrid');
  box.innerHTML='';
  const list=dramas.slice((p-1)*pageSize, p*pageSize);

  list.forEach(d=>{
    const a = Array.isArray(d.actress) ? d.actress.join("„ÄÅ") : (d.actress||'Êú™Áü•');
    box.innerHTML+=`
    <div class="card" onclick="location.href='${d.title_play_url}'">
      <div style="position:relative;">
        <img src="${d.cover_url}">
        <div class="actor">${a}</div>
        <div class="card-type">${d.type||'Êú™Áü•'}</div>
      </div>
      <div class="card-info">
        <div class="card-info-top">
          <span class="idcode">${d.IDcode}</span>
          <span class="title">${d.title}</span>
        </div>
        <div class="card-info-bottom">
          <div class="star">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
          <div class="date">${d.publish_date}</div>
        </div>
      </div>
    </div>`;
  });

  renderPagination();
}

function renderPagination(){
  const total=Math.ceil(dramas.length/pageSize);
  document.getElementById('pagination').innerHTML=`
    <button ${currentPage===1?'disabled':''} onclick="changePage(-1)">‰∏ä‰∏ÄÈ°µ</button>
    <span>Á¨¨ <input id="jump" type="number" min="1" max="${total}" value="${currentPage}"> / ${total} È°µ</span>
    <button onclick="jumpPage()">Ë∑≥ËΩ¨</button>
    <button ${currentPage===total?'disabled':''} onclick="changePage(1)">‰∏ã‰∏ÄÈ°µ</button>
  `;
}

function changePage(s){ currentPage=Math.max(1, currentPage+s); renderPage(currentPage); }
function jumpPage(){ const t=parseInt(document.getElementById('jump').value); const max=Math.ceil(dramas.length/pageSize); if(t>=1&&t<=max){ currentPage=t; renderPage(currentPage);} }

loadDramas();
</script>

</body>
</html>
