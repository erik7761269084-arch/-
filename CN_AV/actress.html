<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å›½äº§å¥³ä¼˜ - åˆ—è¡¨</title>
<style>
body { margin:0; font-family:"å¾®è½¯é›…é»‘",sans-serif; background:#0d0d0d; color:#fff; padding-top:60px; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:20px; padding:20px; justify-items:center; }
.card { background:#1a1a1a; border-radius:10px; overflow:hidden; cursor:pointer; transition:transform .25s ease, box-shadow .25s ease; width:100%; max-width:220px; display:flex; flex-direction:column; }
.card:hover { transform:scale(1.05); box-shadow:0 4px 12px rgba(255,255,255,.2); }
.card img { width:100%; height:260px; object-fit:cover; background:#222; }
.card-title { padding:10px; font-size:15px; text-align:center; color:#eee; }
.card-info { font-size:13px; color:#ccc; text-align:center; padding-bottom:10px; line-height:1.6; }
.pagination { display:flex; justify-content:center; align-items:center; gap:10px; padding:20px 0; }
.pagination button { padding:6px 12px; background:#333; color:#fff; border:none; border-radius:4px; cursor:pointer; }
.pagination button:hover:not(:disabled) { background:#555; }
.pagination button:disabled { opacity:.4; cursor:not-allowed; }
.pagination input { width:50px; padding:4px; background:#222; border:1px solid #555; color:#fff; text-align:center; border-radius:4px; }
/* å›ºå®š header */
#header-placeholder {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 999;
}
</style>
</head>
<body>

<div id="header-placeholder"></div>
<div class="grid" id="actressGrid"></div>
<div class="pagination" id="pagination"></div>

<script>
// ======= é…ç½® =======
const MAX_PAGE = 52;
  
/* ======= åŠ è½½ header.html + header.js ======= */
fetch('header.html')
  .then(res => res.text())
  .then(html => {
    document.getElementById('header-placeholder').innerHTML = html;

    // åŠ è½½ header.js æ–‡ä»¶
    const script = document.createElement('script');
    script.src = 'header.js';
    script.onload = () => {
      if (typeof initHeaderMenu === 'function') initHeaderMenu();
      if (typeof setActiveMenu === 'function') setActiveMenu('menu-drama');
    };
    document.body.appendChild(script);
  });


fetch('https://yunvgong.com/footer.html')
  .then(r => r.text())
  .then(html => {
    const footer = document.createElement('div');
    footer.innerHTML = html;
    document.body.appendChild(footer);
  });

// ======= è·å– URL é¡µç  =======
function getPageFromURL() {
  const params = new URLSearchParams(window.location.search);
  let pages = parseInt(params.get('pages'));
  if (!pages || pages < 1) pages = 1;
  if (pages > MAX_PAGE) pages = MAX_PAGE;
  return pages;
}

// ======= æ¸²æŸ“å¥³ä¼˜å¡ç‰‡ =======
function renderAll(data){
  const box = document.getElementById('actressGrid');
  box.innerHTML = '';
  if(!data || data.length === 0){
    box.innerHTML = "<p style='text-align:center;color:#ccc;'>æš‚æ— æ•°æ®</p>";
    return;
  }

  data.forEach(a => {
    box.innerHTML += `
      <div class="card" onclick="goActress('${a.actress_url}')">
        <img src="${a.img_url || 'https://via.placeholder.com/220x260?text=No+Cover'}">
        <div class="card-title">${a.name}</div>
        <div class="card-info">
          ${a.zodiac ? `ğŸŒŸ ${a.zodiac}<br>` : ""}
          ${a.height ? `ğŸ“ ${a.height}<br>` : ""}
          ${a.measurements ? `ğŸ’ƒ ${a.measurements}` : ""}
        </div>
      </div>
    `;
  });

  // æ¢å¤æ»šåŠ¨ä½ç½®
  const savedScroll = parseInt(localStorage.getItem('actressScroll'));
  if(savedScroll) window.scrollTo(0, savedScroll);
}

// ======= ç‚¹å‡»è·³è½¬å¥³ä¼˜è¯¦æƒ… =======
function goActress(url){
  localStorage.setItem('actressScroll', window.scrollY);
  if(url) location.href = url;
}

// ======= æ¸²æŸ“åˆ†é¡µæ§ä»¶ =======
function renderPagination(currentPage){
  const pagination = document.getElementById('pagination');
  pagination.innerHTML = `
    <button ${currentPage===1?'disabled':''} onclick="changePage(${currentPage-1})">ä¸Šä¸€é¡µ</button>
	<span>ç¬¬ <input id="jumpPage" type="number" min="1" max="${MAX_PAGE}" value="${currentPage}"> é¡µ / ${MAX_PAGE} é¡µ</span>
    <button onclick="jumpToPage()">è·³è½¬</button>
    <button ${currentPage===MAX_PAGE?'disabled':''} onclick="changePage(${currentPage+1})">ä¸‹ä¸€é¡µ</button>
  `;
}

// ======= è·³è½¬é¡µ =======
function jumpToPage(){
  let p = parseInt(document.getElementById('jumpPage').value);
  if(!p || p < 1) p = 1;
  if(p > MAX_PAGE) p = MAX_PAGE;
  location.href = `${window.location.pathname}?pages=${p}`;
}

// ======= ä¸Šä¸‹é¡µåˆ‡æ¢ =======
function changePage(p){
  if(p < 1) p = 1;
  if(p > MAX_PAGE) p = MAX_PAGE;
  location.href = `${window.location.pathname}?pages=${p}`;
}

// ======= åˆå§‹åŒ– =======
const pageNumber = getPageFromURL();
renderPagination(pageNumber);

// ======= åŠ¨æ€åŠ è½½å¯¹åº”é¡µ JS =======
const script = document.createElement('script');
script.src = `https://yunvgong.com/CN_AV/category/actress_page/page_${pageNumber}.js${pageNumber>1 ? '?pages=' + pageNumber : ''}`;
script.onload = () => {
  if(typeof window.PAGE_DATA !== 'undefined'){
    renderAll(window.PAGE_DATA);
  } else {
    console.error(`page_${pageNumber}.js æœªå®šä¹‰ window.PAGE_DATA`);
  }
};
script.onerror = () => console.error(`æ— æ³•åŠ è½½ page_${pageNumber}.js`);
document.body.appendChild(script);

</script>
</body>
</html>
