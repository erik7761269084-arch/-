<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¥³ä¼˜è¯¦æƒ…</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    color: #fff;
    position: relative;
    min-height: 100vh;
    overflow-x: hidden;
    background-color: #000;
  }

  /* èƒŒæ™¯å›¾ */
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    background: var(--bg-url) center center / cover no-repeat;
    filter: brightness(0.3);
    opacity: 0.6;
    z-index: -1;
  }

  .container {
    width: 100%;
    min-height: 100vh;
    padding: 50px 80px;
    background: rgba(0,0,0,0.6);
    box-sizing: border-box;
  }

  .profile {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }

  .profile img {
    width: 350px;
    height: auto;
    border-radius: 10px;
    display: block;
  }

  .info { flex: 1; }
  .info h1 { margin: 0; font-size: 28px; }
  .features span {
    display: inline-block;
    background: #ff9800;
    color: #000;
    padding: 2px 8px;
    margin: 2px;
    border-radius: 4px;
    font-size: 12px;
  }

  .description {
    margin-top: 40px;
  }

  .gallery {
    margin-top: 30px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px,1fr));
    gap: 10px;
  }

  .gallery img {
    width: 100%;
    border-radius: 6px;
    display: block;
  }

  /* === ç›¸å…³å½±ç‰‡ === */
  .related-dramas {
    margin-top: 50px;
  }

  .related-dramas h2 {
    font-size: 24px;
    margin-bottom: 20px;
  }

  .related-dramas .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px,1fr));
    gap: 15px;
  }

  .related-dramas .card {
    position: relative;
    background-color: #1a1a1a;
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    flex-direction: column;
  }
  .related-dramas .card:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(255,255,255,0.2); }
  .related-dramas .card img { width: 100%; aspect-ratio: 16/9; object-fit: cover; }
  .card-type { position: absolute; bottom: 8px; right: 8px; font-size: 12px; font-weight: bold; color: #fff; border: 1px solid #ff0000; padding: 2px 6px; border-radius: 4px; background-color: #ff0000; }
  .card-info { padding: 8px 10px; display: flex; flex-direction: column; gap: 6px; }
  .card-info-top { display: flex; align-items: center; gap: 6px; overflow: hidden; }
  .card-info-top .idcode { color: #ffcc00; font-weight: bold; font-size: 12px; white-space: nowrap; flex-shrink: 0; }
  .card-info-top .title { font-size: 14px; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-grow: 1; }
  .actor { position: absolute; bottom: 8px; left: 8px; background-color: rgba(0,0,0,0.5); padding: 2px 6px; border-radius: 4px; font-size: 12px; }
  .card-info-bottom { display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #ccc; }
  .date { display: flex; align-items: center; gap: 4px; }
  .date::before { content: "í ½í³…"; font-size: 13px; }

  /* åˆ†é¡µ */
  .pagination { margin-top: 10px; display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }
  .pagination button { padding: 4px 8px; background: #333; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
  .pagination button.active { background: red; }
  .pagination input { width: 40px; padding: 2px; border-radius: 4px; border: 1px solid #555; background: #222; color: #fff; text-align: center; }
</style>
</head>
<body>

<div class="container">
  <!-- === æ¼”å‘˜ä¿¡æ¯ === -->
  <div class="profile">
    <img id="profile-img" src="" alt="">
    <div class="info">
      <h1 id="name"></h1>
      <p>å¹´é¾„: <span id="age"></span></p>
      <p>ç”Ÿæ—¥: <span id="birthday"></span></p>
      <p>æ˜Ÿåº§: <span id="zodiac"></span></p>
      <p>èº«é«˜: <span id="height"></span></p>
      <p>ä¸‰å›´: <span id="measurements"></span></p>
      <p>ç½©æ¯: <span id="cup"></span></p>
      <p>ä½œå“æ•°é‡: <span id="works_count"></span></p>
      <div class="features" id="features"></div>
      <p>åˆ«å: <span id="aliases"></span></p>
    </div>
  </div>

  <!-- === ç®€ä»‹ === -->
  <div class="description">
    <h2>ç®€ä»‹</h2>
    <p id="description"></p>
  </div>

  <!-- === å›¾é›† === -->
  <div class="gallery" id="gallery"></div>

  <!-- === ç›¸å…³å½±ç‰‡ === -->
  <div class="related-dramas">
    <h2>è¯¥å¥³ä¼˜å‡ºæ¼”å½±ç‰‡</h2>
    <div class="grid" id="relatedDramasGrid"></div>
    <div class="pagination" id="relatedPagination"></div>
  </div>
</div>

<script>
// ä» URL è·å– series å‚æ•°
function getSeriesName() {
  const params = new URLSearchParams(window.location.search);
  return params.get('series') || '1'; // é»˜è®¤ 1
}

// åŠ¨æ€åŠ è½½ JS æ•°æ®æ–‡ä»¶
function loadSeriesData(seriesName) {
  const script = document.createElement('script');
  script.src = "CN_actress_menu/" + seriesName + "_AVactress_data.js"; 
  script.onload = () => {
    if (window.actressData) {
      initPage(window.actressData);
    } else if (typeof actressData !== 'undefined') {
      initPage(actressData);
    } else {
      alert("actressData æœªå®šä¹‰ï¼Œæ£€æŸ¥æ•°æ®æ–‡ä»¶æ ¼å¼ã€‚");
    }
  };
  script.onerror = () => alert("å‰§é›†æ•°æ®åŠ è½½å¤±è´¥: " + seriesName);
  document.body.appendChild(script);
}

// === åˆå§‹åŒ–é¡µé¢ ===
function initPage(actressData) {
  if (!actressData) return;

  // èƒŒæ™¯å›¾
  if (actressData.background_img) {
    document.body.style.setProperty('--bg-url', `url('${actressData.background_img}')`);
  }

  // å¡«å……æ¼”å‘˜ä¿¡æ¯
  const profileImg = document.getElementById("profile-img");
  profileImg.src = actressData.img_url || "";
  profileImg.alt = actressData.name || "";
  profileImg.onerror = () => profileImg.style.display = 'none';

  document.getElementById("name").textContent = actressData.name || "";
  document.getElementById("age").textContent = actressData.age || "";
  document.getElementById("birthday").textContent = actressData.birthday_date || "";
  document.getElementById("zodiac").textContent = actressData.zodiac || "";
  document.getElementById("height").textContent = actressData.height || "";
  document.getElementById("measurements").textContent = actressData.measurements || "";
  document.getElementById("cup").textContent = actressData.cup || "";
  document.getElementById("works_count").textContent = actressData.works_count || 0;
  document.getElementById("description").textContent = actressData.description || "";

  // ç‰¹å¾æ ‡ç­¾
  const featuresDiv = document.getElementById("features");
  featuresDiv.innerHTML = "";
  if (Array.isArray(actressData.features)) {
    actressData.features.forEach(f => {
      const span = document.createElement("span");
      span.textContent = f;
      featuresDiv.appendChild(span);
    });
  }

  // åˆ«å
  document.getElementById("aliases").textContent = Array.isArray(actressData.aliases)
    ? actressData.aliases.join(", ")
    : (actressData.aliases || "");

  // å›¾é›†
  const galleryDiv = document.getElementById("gallery");
  galleryDiv.innerHTML = "";
  if (Array.isArray(actressData.gallery)) {
    actressData.gallery.forEach(url => {
      const img = document.createElement("img");
      img.src = url;
      img.alt = "å†™çœŸå›¾é›†";
      img.onerror = () => img.style.display = 'none';
      galleryDiv.appendChild(img);
    });
  }

  // åˆå§‹åŒ–ç›¸å…³å½±ç‰‡
  initRelatedDramas(actressData.related_dramas);
}

// === ç›¸å…³å½±ç‰‡åˆ†é¡µ ===
let relatedDramas = [], relatedFiltered = [], relatedCurrentPage = 1, relatedPageSize = 12;

function renderRelatedPage(page) {
  const container = document.getElementById('relatedDramasGrid');
  container.innerHTML = '';
  const start = (page - 1) * relatedPageSize;
  const end = start + relatedPageSize;
  const pageData = relatedFiltered.slice(start, end);

  pageData.forEach(d => {
    const card = document.createElement('div');
    card.className = 'card';
    card.onclick = () => window.open(d.title_play_url, "_blank");

    card.innerHTML = `
      <div style="position: relative;">
        <img src="${d.cover_url}" alt="${d.title}">
        <div class="actor">${Array.isArray(d.actress)? d.actress.join(", "): d.actress}</div>
        <div class="card-type">${d.type}</div>
      </div>
      <div class="card-info">
        <div class="card-info-top">
          <span class="idcode">${d.IDcode}</span>
          <span class="title">${d.title}</span>
        </div>
        <div class="card-info-bottom">
          <div class="date">${d.publish_date || ""}</div>
        </div>
      </div>
    `;
    container.appendChild(card);
  });

  // åˆ†é¡µ
  const pagination = document.getElementById('relatedPagination');
  pagination.innerHTML = '';
  const totalPages = Math.ceil(relatedFiltered.length / relatedPageSize);

  const prevBtn = document.createElement('button');
  prevBtn.textContent = 'ä¸Šä¸€é¡µ';
  prevBtn.disabled = relatedCurrentPage === 1;
  prevBtn.onclick = () => { if(relatedCurrentPage>1){ relatedCurrentPage--; renderRelatedPage(relatedCurrentPage); } };
  pagination.appendChild(prevBtn);

  const pageInfo = document.createElement('span');
  pageInfo.innerHTML = `ç¬¬ <input type="number" min="1" max="${totalPages}" value="${relatedCurrentPage}" id="jumpRelatedPage"> é¡µ / å…± ${totalPages} é¡µ`;
  pagination.appendChild(pageInfo);

  const jumpBtn = document.createElement('button');
  jumpBtn.textContent = 'è·³è½¬';
  jumpBtn.onclick = () => {
    const val = parseInt(document.getElementById('jumpRelatedPage').value);
    if(val>=1 && val<=totalPages) { relatedCurrentPage = val; renderRelatedPage(relatedCurrentPage); }
  };
  pagination.appendChild(jumpBtn);

  const nextBtn = document.createElement('button');
  nextBtn.textContent = 'ä¸‹ä¸€é¡µ';
  nextBtn.disabled = relatedCurrentPage === totalPages;
  nextBtn.onclick = () => { if(relatedCurrentPage<totalPages){ relatedCurrentPage++; renderRelatedPage(relatedCurrentPage); } };
  pagination.appendChild(nextBtn);
}

function initRelatedDramas(dramas) {
  if(Array.isArray(dramas) && dramas.length>0) {
    relatedDramas = dramas;
    relatedFiltered = relatedDramas;
    renderRelatedPage(relatedCurrentPage);
  } else {
    document.getElementById('relatedDramasGrid').innerHTML = "<p>æš‚æ— ç›¸å…³å½±ç‰‡</p>";
  }
}

// æ‰§è¡ŒåŠ è½½
const seriesName = getSeriesName();
loadSeriesData(seriesName);
</script>

</body>
</html>
