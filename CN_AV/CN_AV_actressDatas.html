<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¥³ä¼˜è¯¦æƒ…</title>

<style>
  :root {
    --page-padding: 50px 80px;
  }

  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    color: #fff;
    position: relative;
    min-height: 100vh;
    overflow-x: hidden;
    background-color: #000;
    padding-top: 60px;
  }

  body::before {
    content: "";
    position: fixed; top:0; left:0;
    width:100%; height:100%;
    background: var(--bg-url) center center / cover no-repeat;
    filter: brightness(0.3);
    opacity:0.6;
    z-index:-1;
  }

  .container {
    width: 100%;
    min-height: 100vh;
    padding: var(--page-padding);
    background: rgba(0,0,0,0.6);
    box-sizing: border-box;
  }

  /* ===== æ¼”å‘˜ä¿¡æ¯ ===== */
  .profile {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    align-items: flex-start;
  }

  .profile img {
    width: 350px;
    max-width: 100%;
    border-radius: 10px;
    object-fit: cover;
  }

  .info {
    flex: 1;
    min-width: 250px;
  }

  .info h1 { margin:0; font-size:28px; }

  .features span {
    display:inline-block;
    background:#ff9800; color:#000;
    padding:2px 8px; margin:2px;
    border-radius:4px; font-size:12px;
  }

  .description { margin-top: 40px; }

  /* ===== å›¾é›† ===== */
  .gallery {
    margin-top: 30px;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px,1fr));
    gap:10px;
  }

  .gallery img {
    width:100%;
    border-radius:6px;
    display:block;
  }

  /* ===== ä½œå“å¡ç‰‡ ===== */
  .related-dramas { margin-top:50px; }
  .related-dramas h2 { font-size:24px; margin-bottom:20px; }

  .related-dramas .grid {
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(180px,1fr));
    gap:15px;
  }

  .related-dramas .card {
    position:relative;
    background-color:#1a1a1a;
    border-radius:8px;
    overflow:hidden;
    cursor:pointer;
    display:flex;
    flex-direction:column;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .related-dramas .card:hover {
    transform: scale(1.05);
    box-shadow:0 4px 12px rgba(255,255,255,0.2);
  }

  .related-dramas .card img {
    width:100%;
    aspect-ratio:16/9;
    object-fit:cover;
  }

  .card-type {
    position:absolute; bottom:8px; right:8px;
    font-size:12px; font-weight:bold; color:#fff;
    border:1px solid #ff0000;
    padding:2px 6px; border-radius:4px;
    background-color:#ff0000;
  }

  .card-info { padding:8px 10px; display:flex; flex-direction:column; gap:6px; }

  .card-info-top {
    display:flex; align-items:center; gap:6px; overflow:hidden;
  }
  .card-info-top .idcode {
    color:#ffcc00; font-weight:bold; font-size:12px;
    white-space:nowrap; flex-shrink:0;
  }
  .card-info-top .title {
    font-size:14px; color:#fff;
    white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    flex-grow:1;
  }
  .actor {
    position:absolute; bottom:8px; left:8px;
    background-color: rgba(0,0,0,0.5);
    padding:2px 6px; border-radius:4px; font-size:12px;
  }

  .card-info-bottom {
    display:flex; justify-content:space-between;
    align-items:center; font-size:12px; color:#ccc;
  }

  .date { display:flex; align-items:center; gap:4px; font-size:12px; }

  /* ===== ç¿»é¡µ ===== */
  .pagination {
    margin-top:10px;
    display:flex; align-items:center;
    gap:6px; flex-wrap:wrap;
  }
  .pagination button {
    padding:4px 8px; background:#333; color:#fff;
    border:none; border-radius:4px; cursor:pointer;
  }
  .pagination button.active { background:red; }
  .pagination input {
    width:40px; padding:2px;
    border-radius:4px; border:1px solid #555;
    background:#222; color:#fff; text-align:center;
  }

  /************** ğŸ“± Mobile Responsive **************/
  @media(max-width: 1024px){
    :root { --page-padding: 40px; }
  }

  @media(max-width: 768px){
    :root { --page-padding: 20px; }
    .info h1 { font-size:22px; }
    .gallery { grid-template-columns: repeat(auto-fill, minmax(150px,1fr)); }
    .related-dramas .grid { grid-template-columns: repeat(auto-fill, minmax(150px,1fr)); }
  }

  @media(max-width: 480px){
    .profile { flex-direction: column; align-items: center; text-align:center; }
    .features span { font-size:11px; }
    .info p { font-size:14px; }
    .gallery { grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); }
    .related-dramas .grid { grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); }
  }
</style>
</head>
<body>

<div id="header-placeholder"></div>

<div class="container">
  <!-- ===== æ¼”å‘˜ä¿¡æ¯ ===== -->
  <div class="profile">
    <img id="profile-img" src="" alt="">
    <div class="info">
      <h1 id="name"></h1>
      <p>å¹´é¾„: <span id="age"></span></p>
      <p>ç”Ÿæ—¥: <span id="birthday"></span></p>
      <p>æ˜Ÿåº§: <span id="zodiac"></span></p>
      <p>èº«é«˜: <span id="height"></span></p>
      <p>ä¸‰å›´: <span id="measurements"></span></p>
      <p>ç½©æ¯: <span id="cup"></span></p>
      <p>ä½œå“æ•°é‡: <span id="works_count"></span></p>
      <div class="features" id="features"></div>
      <p>åˆ«å: <span id="aliases"></span></p>
    </div>
  </div>

  <div class="description">
    <h2>ç®€ä»‹</h2>
    <p id="description"></p>
  </div>

  <div class="gallery" id="gallery"></div>

  <div class="related-dramas">
    <h2>è¯¥å¥³ä¼˜å‡ºæ¼”å½±ç‰‡</h2>
    <div class="grid" id="relatedDramasGrid"></div>
    <div class="pagination" id="relatedPagination"></div>
  </div>
</div>

<script>
/*** åŠ è½½ header.html + header.js ***/
fetch('header.html')
  .then(res => res.text())
  .then(html => {
    document.getElementById('header-placeholder').innerHTML = html;
    const script = document.createElement('script');
    script.src = 'header.js';
    script.onload = () => {
      if (typeof initHeaderMenu === 'function') initHeaderMenu();
      if (typeof setActiveMenu === 'function') setActiveMenu('menu-actress');
    };
    document.body.appendChild(script);
  });

/*** åŠ è½½ footer.html ***/
fetch('https://yunvgong.com/footer.html')
  .then(r => r.text())
  .then(html => {
    let footer = document.getElementById('footer-placeholder');
    if (!footer) {
      footer = document.createElement('div');
      footer.id = 'footer-placeholder';
      document.body.appendChild(footer);
    }
    footer.innerHTML = html;
  })
  .catch(e => console.warn('æ— æ³•åŠ è½½ footer.html:', e));


/* åŸæœ‰é¡µé¢é€»è¾‘ */
function getSeriesName() {
  return new URLSearchParams(window.location.search).get('series') || '1';
}

function loadSeriesData(seriesName) {
  const script = document.createElement('script');
  script.src = "CN_actress_menu/" + seriesName + "_AVactress_data.js"; 
  script.onload = () => {
    if (window.actressData) initPage(window.actressData);
    else if (typeof actressData !== 'undefined') initPage(actressData);
    else alert("actressData æœªå®šä¹‰ï¼Œæ£€æŸ¥æ•°æ®æ–‡ä»¶æ ¼å¼ã€‚");
  };
  script.onerror = () => alert("å‰§é›†æ•°æ®åŠ è½½å¤±è´¥: " + seriesName);
  document.body.appendChild(script);
}

function initPage(data) {
  if (!data) return;
  if (data.background_img) document.body.style.setProperty('--bg-url', `url('${data.background_img}')`);

  document.getElementById("profile-img").src = data.img_url || "";
  document.getElementById("name").textContent = data.name || "";
  document.getElementById("age").textContent = data.age || "";
  document.getElementById("birthday").textContent = data.birthday_date || "";
  document.getElementById("zodiac").textContent = data.zodiac || "";
  document.getElementById("height").textContent = data.height || "";
  document.getElementById("measurements").textContent = data.measurements || "";
  document.getElementById("cup").textContent = data.cup || "";
  document.getElementById("works_count").textContent = data.works_count || 0;
  document.getElementById("description").textContent = data.description || "";

  const featuresDiv = document.getElementById("features");
  featuresDiv.innerHTML = "";
  if (Array.isArray(data.features)) {
    data.features.forEach(f => {
      const span = document.createElement("span");
      span.textContent = f;
      featuresDiv.appendChild(span);
    });
  }

  document.getElementById("aliases").textContent = Array.isArray(data.aliases)
    ? data.aliases.join(", ")
    : (data.aliases || "");

  const galleryDiv = document.getElementById("gallery");
  galleryDiv.innerHTML = "";
  if (Array.isArray(data.gallery)) {
    data.gallery.forEach(url => {
      const img = document.createElement("img");
      img.src = url;
      img.onerror = () => img.style.display = 'none';
      galleryDiv.appendChild(img);
    });
  }

  initRelatedDramas(data.related_dramas);
}

/********************************/
let relatedDramas = [], relatedFiltered = [];
let relatedCurrentPage = 1, relatedPageSize = 12;

function renderRelatedPage(page) {
  const container = document.getElementById('relatedDramasGrid');
  container.innerHTML = '';
  const start = (page - 1) * relatedPageSize;
  const end = start + relatedPageSize;
  const pageData = relatedFiltered.slice(start, end);

  pageData.forEach(d => {
    const card = document.createElement('div');
    card.className = 'card';
    card.onclick = () => window.open(d.title_play_url, "_blank");

    card.innerHTML = `
      <div style="position: relative;">
        <img src="${d.cover_url}" alt="${d.title}">
        <div class="actor">${Array.isArray(d.actress)? d.actress.join(", "): d.actress}</div>
        <div class="card-type">${d.type}</div>
      </div>
      <div class="card-info">
        <div class="card-info-top">
          <span class="idcode">${d.IDcode}</span>
          <span class="title">${d.title}</span>
        </div>
        <div class="card-info-bottom">
          <div class="date">${d.publish_date || ""}</div>
        </div>
      </div>
    `;
    container.appendChild(card);
  });

  const pagination = document.getElementById('relatedPagination');
  pagination.innerHTML = '';
  const totalPages = Math.ceil(relatedFiltered.length / relatedPageSize);

  const prevBtn = document.createElement('button');
  prevBtn.textContent = 'ä¸Šä¸€é¡µ';
  prevBtn.disabled = (page === 1);
  prevBtn.onclick = () => { relatedCurrentPage--; renderRelatedPage(relatedCurrentPage); };
  pagination.appendChild(prevBtn);

  const pageInfo = document.createElement('span');
  pageInfo.innerHTML = `ç¬¬ <input type="number" min="1" max="${totalPages}" value="${page}" id="jumpRelatedPage"> é¡µ / å…± ${totalPages} é¡µ`;
  pagination.appendChild(pageInfo);

  const jumpBtn = document.createElement('button');
  jumpBtn.textContent = 'è·³è½¬';
  jumpBtn.onclick = () => {
    const val = parseInt(document.getElementById('jumpRelatedPage').value);
    if(val>=1 && val<=totalPages) { relatedCurrentPage = val; renderRelatedPage(val); }
  };
  pagination.appendChild(jumpBtn);

  const nextBtn = document.createElement('button');
  nextBtn.textContent = 'ä¸‹ä¸€é¡µ';
  nextBtn.disabled = (page === totalPages);
  nextBtn.onclick = () => { relatedCurrentPage++; renderRelatedPage(relatedCurrentPage); };
  pagination.appendChild(nextBtn);
}

function initRelatedDramas(dramas) {
  if (Array.isArray(dramas) && dramas.length > 0) {
    relatedDramas = dramas;
    relatedFiltered = dramas;
    renderRelatedPage(relatedCurrentPage);
  } else {
    document.getElementById('relatedDramasGrid').innerHTML = "<p>æš‚æ— ç›¸å…³å½±ç‰‡</p>";
  }
}

const seriesName = getSeriesName();
loadSeriesData(seriesName);
</script>

</body>
</html>
